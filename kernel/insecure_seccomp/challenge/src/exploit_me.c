// SPDX-License-Identifier: Apache-2.0
/*
 * Copyright 2021 Google LLC.
 */

#include <assert.h>
#include <fcntl.h>
#include <stdio.h>
#include <unistd.h>

int main(int argc, char *argv[])
{
	if (!faccessat(AT_FDCWD, "/flag", R_OK, AT_EACCESS)) {
		fprintf(stderr, "You can't be root to execute this! ... or can you?\n");
		return 1;
	}

	setuid(geteuid());

	execl("/bin/sh", "sh", NULL);
	perror("execl");
	return 1;
}
